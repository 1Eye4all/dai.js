 version: 2
 jobs:
   build:
     docker:
       - image: levity/dapptools-node
     steps:
       - checkout
       - run:
          name: Install dependencies
          command: |
            npm i --no-save yarn codecov
            yarn
       - run:
          name: Run tests
          command: |
            source /home/circleci/setup-env.sh
            yarn lerna bootstrap
            yarn build
            yarn test:build
            yarn coverage
       - run:
          name: Update codecov
          command: ./node_modules/.bin/codecov
